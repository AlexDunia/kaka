import{u as K}from"./auth-BUdO578h.js";import{u as O}from"./purchases-Btm-l5d7.js";import{_ as q,o as z,s as W,w as G,x as H,l as S,y as b,d as n,h as v,e,t as s,z as $,n as J,p as Q,A as T,T as R,B as X,k as a,r as h,c as C,i as w,C as Z,F as U,j as E,m as B,q as L}from"./index-Coq0l3Fl.js";const ee={class:"modal-header"},te={class:"modal-title"},se={class:"modal-body"},oe={key:0,class:"modal-footer"},ae=Object.assign({name:"BaseModal"},{__name:"Modal",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},width:{type:String,default:"550px"},showClose:{type:Boolean,default:!0},size:{type:String,default:"md",validator:u=>["sm","md","lg","xl"].includes(u)},preventClose:{type:Boolean,default:!1}},emits:["close"],setup(u,{emit:g}){const i=u,y=g,k=l=>{l.key==="Escape"&&i.show&&!i.preventClose&&y("close")},d=l=>{l?document.body.style.overflow="hidden":document.body.style.overflow=""};z(()=>{document.addEventListener("keydown",k)}),W(()=>{document.removeEventListener("keydown",k),d(!1)}),G(()=>i.show,l=>{d(l)});const m=()=>{i.preventClose||y("close")},_=l=>{l.target===l.currentTarget&&!i.preventClose&&y("close")};return(l,r)=>(a(),H(X,{to:"body"},[S(R,{name:"modal-fade"},{default:b(()=>[u.show?(a(),n("div",{key:0,class:"modal-overlay",onClick:_},[e("div",{class:T(["modal-container",`modal-${u.size}`]),style:Q({maxWidth:u.width}),onClick:r[0]||(r[0]=J(()=>{},["stop"]))},[e("div",ee,[e("h3",te,s(u.title),1),u.showClose?(a(),n("button",{key:0,class:"modal-close",onClick:m,"aria-label":"Close"},r[1]||(r[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))):v("",!0)]),e("div",se,[$(l.$slots,"default",{},void 0,!0)]),l.$slots.footer?(a(),n("div",oe,[$(l.$slots,"footer",{},void 0,!0)])):v("",!0)],6)])):v("",!0)]),_:3})]))}}),ne=q(ae,[["__scopeId","data-v-0f688b28"]]),le={class:"dashboard"},ie={class:"container"},de={class:"dashboard__header"},re={class:"dashboard__greeting"},ce={key:0,class:"dashboard__loading"},ue={key:1,class:"dashboard__error"},_e={key:2,class:"dashboard__content"},he={class:"dashboard__stats"},ve={class:"dashboard__stat-card"},ye={class:"dashboard__stat-value"},ke={class:"dashboard__stat-card"},me={class:"dashboard__stat-value"},we={class:"dashboard__stat-card"},pe={class:"dashboard__stat-value"},fe={class:"dashboard__section"},be={key:0,class:"dashboard__empty"},ge={key:1,class:"dashboard__tickets"},xe={class:"ticket-card__header"},Ce={class:"ticket-card__event"},Be={class:"ticket-card__details"},Se={class:"ticket-card__info"},Te={class:"ticket-card__info-item"},Pe={class:"ticket-card__info-item"},De={class:"ticket-card__info-item"},Me={class:"ticket-card__actions"},je={class:"ticket-card__price"},$e=["onClick"],Ue={key:0,class:"dashboard__section"},Ee={class:"dashboard__tickets"},Le={class:"ticket-card__header"},qe={class:"ticket-card__event"},ze={class:"ticket-card__details"},Ne={class:"ticket-card__info"},Ve={class:"ticket-card__info-item"},Fe={class:"ticket-card__info-item"},Ye={class:"ticket-card__info-item"},Ae={class:"ticket-card__price"},Ie={key:0,class:"cancel-modal"},Ke={key:0,class:"cancel-modal__error"},Oe={class:"cancel-modal__message"},We={class:"cancel-modal__details"},Ge={key:1,class:"cancel-modal__success"},He=["disabled"],Je=["disabled"],Qe={key:0},Re={key:1},Xe={__name:"Dashboard",setup(u){const g=K(),i=O(),y=h(!0),k=h(null),d=h(null),m=h(!1),_=h(!1),l=h(null),r=h(!1);z(async()=>{try{await i.fetchUserPurchases()}catch(c){k.value=c.message||"Failed to load your purchases"}finally{y.value=!1}});const P=c=>new Date(c).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=c=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(c),N=c=>{d.value=c,m.value=!0,l.value=null,r.value=!1},V=async()=>{if(d.value){_.value=!0,l.value=null;try{await i.cancelPurchase(d.value.id),r.value=!0,setTimeout(()=>{f(),i.fetchUserPurchases()},2e3)}catch(c){l.value=c.message||"Failed to cancel purchase"}finally{_.value=!1}}},f=()=>{_.value||(m.value=!1,d.value=null,r.value=!1)},F=C(()=>i.upcomingPurchases.length>0),Y=C(()=>i.pastPurchases.length>0),A=C(()=>p(i.totalSpent));return(c,t)=>{var D;const I=Z("router-link");return a(),n("div",le,[e("div",ie,[e("header",de,[t[0]||(t[0]=e("h1",{class:"dashboard__title"},"Your Dashboard",-1)),e("p",re,"Welcome back, "+s((D=w(g).user)==null?void 0:D.name),1)]),y.value?(a(),n("div",ce,"Loading your purchases...")):k.value?(a(),n("div",ue,s(k.value),1)):(a(),n("div",_e,[e("div",he,[e("div",ve,[e("div",ye,s(w(i).purchases.length),1),t[1]||(t[1]=e("div",{class:"dashboard__stat-label"},"Total Bookings",-1))]),e("div",ke,[e("div",me,s(w(i).upcomingPurchases.length),1),t[2]||(t[2]=e("div",{class:"dashboard__stat-label"},"Upcoming Events",-1))]),e("div",we,[e("div",pe,s(A.value),1),t[3]||(t[3]=e("div",{class:"dashboard__stat-label"},"Total Spent",-1))])]),e("section",fe,[t[9]||(t[9]=e("h2",{class:"dashboard__section-title"},"Upcoming Tickets",-1)),F.value?(a(),n("div",ge,[(a(!0),n(U,null,E(w(i).upcomingPurchases,o=>(a(),n("div",{key:o.id,class:"ticket-card"},[e("div",xe,[e("div",Ce,s(o.eventTitle),1),e("div",{class:T(["ticket-card__status",{"ticket-card__status--cancelled":o.status==="cancelled"}])},s(o.status),3)]),e("div",Be,[e("div",Se,[e("div",Te,[t[6]||(t[6]=L('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-18bdcb40><rect x="3" y="4" width="18" height="18" rx="2" ry="2" data-v-18bdcb40></rect><line x1="16" y1="2" x2="16" y2="6" data-v-18bdcb40></line><line x1="8" y1="2" x2="8" y2="6" data-v-18bdcb40></line><line x1="3" y1="10" x2="21" y2="10" data-v-18bdcb40></line></svg>',1)),e("span",null,s(P(o.eventDate)),1)]),e("div",Pe,[t[7]||(t[7]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),e("circle",{cx:"12",cy:"10",r:"3"})],-1)),e("span",null,s(o.eventLocation),1)]),e("div",De,[t[8]||(t[8]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),e("line",{x1:"1",y1:"10",x2:"23",y2:"10"})],-1)),e("span",null,s(o.quantity)+" "+s(o.quantity>1?"tickets":"ticket"),1)])]),e("div",Me,[e("div",je,s(p(o.totalPrice)),1),o.status==="confirmed"?(a(),n("button",{key:0,class:"ticket-card__cancel-btn",onClick:x=>N(o)}," Cancel ",8,$e)):v("",!0)])])]))),128))])):(a(),n("div",be,[t[5]||(t[5]=e("p",null,"You don't have any upcoming events.",-1)),S(I,{to:"/",class:"dashboard__browse-link"},{default:b(()=>t[4]||(t[4]=[B("Browse Events")])),_:1})]))]),Y.value?(a(),n("section",Ue,[t[13]||(t[13]=e("h2",{class:"dashboard__section-title"},"Past Events",-1)),e("div",Ee,[(a(!0),n(U,null,E(w(i).pastPurchases,o=>(a(),n("div",{key:o.id,class:"ticket-card ticket-card--past"},[e("div",Le,[e("div",qe,s(o.eventTitle),1),e("div",{class:T(["ticket-card__status",{"ticket-card__status--cancelled":o.status==="cancelled"}])},s(o.status),3)]),e("div",ze,[e("div",Ne,[e("div",Ve,[t[10]||(t[10]=L('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-18bdcb40><rect x="3" y="4" width="18" height="18" rx="2" ry="2" data-v-18bdcb40></rect><line x1="16" y1="2" x2="16" y2="6" data-v-18bdcb40></line><line x1="8" y1="2" x2="8" y2="6" data-v-18bdcb40></line><line x1="3" y1="10" x2="21" y2="10" data-v-18bdcb40></line></svg>',1)),e("span",null,s(P(o.eventDate)),1)]),e("div",Fe,[t[11]||(t[11]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),e("circle",{cx:"12",cy:"10",r:"3"})],-1)),e("span",null,s(o.eventLocation),1)]),e("div",Ye,[t[12]||(t[12]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),e("line",{x1:"1",y1:"10",x2:"23",y2:"10"})],-1)),e("span",null,s(o.quantity)+" "+s(o.quantity>1?"tickets":"ticket"),1)])]),e("div",Ae,s(p(o.totalPrice)),1)])]))),128))])])):v("",!0)]))]),S(ne,{show:m.value,title:"Cancel Ticket",onClose:f,"prevent-close":_.value},{footer:b(()=>[r.value?v("",!0):(a(),n("button",{key:0,type:"button",class:"cancel-modal__cancel",onClick:f,disabled:_.value}," Keep Tickets ",8,He)),r.value?(a(),n("button",{key:2,type:"button",class:"cancel-modal__close",onClick:f}," Close ")):(a(),n("button",{key:1,type:"button",class:"cancel-modal__confirm",onClick:V,disabled:_.value},[_.value?(a(),n("span",Qe,"Processing...")):(a(),n("span",Re,"Confirm Cancellation"))],8,Je))]),default:b(()=>{var o,x,M,j;return[r.value?(a(),n("div",Ge,t[16]||(t[16]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"50",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),e("h3",null,"Cancellation Successful",-1),e("p",null,"Your tickets have been successfully cancelled and a refund will be processed.",-1)]))):(a(),n("div",Ie,[l.value?(a(),n("div",Ke,s(l.value),1)):v("",!0),e("p",Oe,[t[14]||(t[14]=B(" Are you sure you want to cancel your tickets for ")),e("strong",null,s((o=d.value)==null?void 0:o.eventTitle),1),t[15]||(t[15]=B("? "))]),e("p",We," You will receive a refund of "+s(p((x=d.value)==null?void 0:x.totalPrice))+" for "+s((M=d.value)==null?void 0:M.quantity)+" "+s(((j=d.value)==null?void 0:j.quantity)>1?"tickets":"ticket")+". ",1)]))]}),_:1},8,["show","prevent-close"])])}}},st=q(Xe,[["__scopeId","data-v-18bdcb40"]]);export{st as default};
