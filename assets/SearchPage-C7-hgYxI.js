import{_ as ee,c as i,a as e,b as q,t as p,o,u as de,r as c,d as F,e as he,f as _e,w as pe,g as me,h as C,v as I,i as fe,F as M,j as T,n as Z,k as W,l as ye,m as ge,p as X,q as be,s as xe}from"./index-DyY8Ujzr.js";const ke={class:"loading-indicator"},Se=["data-size"],Ce={key:0,class:"loading-text"},qe={__name:"LoadingIndicator",props:{text:{type:String,default:"Loading..."},showText:{type:Boolean,default:!0},size:{type:String,default:"md",validator:m=>["sm","md","lg"].includes(m)}},setup(m){return(x,n)=>(o(),i("div",ke,[e("div",{class:"spinner","data-size":m.size},null,8,Se),m.showText?(o(),i("p",Ce,p(m.text),1)):q("",!0)]))}},we=ee(qe,[["__scopeId","data-v-2aff78d7"]]),Q={log:(...m)=>{},error:(...m)=>{},warn:(...m)=>{},info:(...m)=>{}},Fe={class:"search-page"},Me={class:"search-hero"},Te={class:"container"},$e={class:"search-hero__content"},Ve={class:"search-hero__search"},Ie={key:0,class:"recent-searches"},Ae={class:"recent-searches__list"},Be=["onClick"],Ne={class:"search-hero__categories"},ze=["onClick"],Ee={class:"search-results"},Le={class:"container"},Ue={class:"search-results__header"},Oe={class:"search-results__title-wrapper"},je={class:"section-title"},Pe={key:0},He={key:1},Je={key:2},Ke={key:3,class:"search-results__count"},Ze={key:0,class:"search-results__showing"},Ye={class:"search-results__controls"},De={key:0,class:"filter-badge"},Ge={class:"sort-dropdown"},We=["value"],Xe={key:0,class:"advanced-filters"},Qe={class:"advanced-filters__content"},Re={class:"filter-section"},et={class:"filter-options"},tt=["id","value"],st=["for"],lt={class:"filter-section"},at={class:"date-range-inputs"},it={class:"date-input-group"},ot={class:"date-input-group"},rt={class:"filter-section"},nt={class:"price-range-inputs"},ut={class:"price-input-group"},ct={class:"price-input-group"},vt={key:1,class:"loading-container"},dt={key:2,class:"error-container"},ht={key:3,class:"no-results-container"},_t={key:4,class:"search-results__grid"},pt={key:5,class:"pagination"},mt=["disabled"],ft={class:"pagination__pages"},yt=["onClick","disabled"],gt=["disabled"],R=5,bt={__name:"SearchPage",setup(m){const x=de(),n=_e(),E=me(),v=c(""),$=c(!0),V=c(null),A=c(!1),B=c(!1),d=c("all"),h=c({from:"",to:""}),_=c({min:"",max:""}),k=c("event_date_asc"),u=c(1),f=F(()=>Math.ceil(S.value/L.value)),L=c(12),y=c(JSON.parse(localStorage.getItem("recentSearches")||"[]")),Y=c(20),te=c(se());function se(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}he(async()=>{try{n.query.q&&(v.value=n.query.q),n.query.category&&(d.value=n.query.category),n.query.page&&(u.value=parseInt(n.query.page)||1),n.query.sort&&(k.value=n.query.sort),n.query.date_from&&(h.value.from=n.query.date_from),n.query.date_to&&(h.value.to=n.query.date_to),n.query.price_min&&(_.value.min=n.query.price_min),n.query.price_max&&(_.value.max=n.query.price_max),B.value=O(),await w()}catch{V.value="Failed to initialize search page. Please try refreshing."}finally{$.value=!1}}),pe([v,d,u,k,h,_],async([l,t,a,s,r,g],[H,J,K,G,N,z])=>{if(l!==H||t!==J||a!==K||s!==G||r.from!==N.from||r.to!==N.to||g.min!==z.min||g.max!==z.max){if(H===""&&J==="all"&&K===1)return;const b={};l&&(b.q=l),t&&t!=="all"&&(b.category=t),a>1&&(b.page=a),s&&s!=="event_date_asc"&&(b.sort=s),r.from&&(b.date_from=r.from),r.to&&(b.date_to=r.to),g.min&&(b.price_min=g.min),g.max&&(b.price_max=g.max),E.push({query:b}),B.value=O(),a===K&&(l!==H||t!==J||s!==G||r.from!==N.from||r.to!==N.to||g.min!==z.min||g.max!==z.max)&&(u.value=1),await w()}},{deep:!0});const w=async()=>{if(!v.value.trim()&&!O()){await x.resetFilters(),E.push({query:{}}),$.value=!1;return}try{$.value=!0,V.value=null;const[l,t]=k.value.split("_"),a={query:v.value,category:d.value!=="all"?d.value:null,page:u.value,limit:L.value,sort:l,direction:t,date_from:h.value.from,date_to:h.value.to,price_min:_.value.min,price_max:_.value.max,csrf:te.value};Q.log("Performing search with params",a);const s=await x.searchEvents(a.query,a.category,a.page,a.limit,a.sort,a.direction,a.date_from,a.date_to,a.price_min,a.price_max);Q.log("Search results received",{count:(s==null?void 0:s.length)||0,totalItems:x.totalItems}),Y.value=20,v.value.trim()&&ae(v.value.trim())}catch(l){V.value=l.message||"Search failed. Please try again."}finally{$.value=!1}},le=async l=>{d.value=l,u.value=1},ae=l=>{const t=y.value.indexOf(l);t!==-1&&y.value.splice(t,1),y.value.unshift(l),y.value.length>R&&(y.value=y.value.slice(0,R)),localStorage.setItem("recentSearches",JSON.stringify(y.value))},ie=l=>{v.value=l,w()},oe=()=>{y.value=[],localStorage.removeItem("recentSearches")},U=async()=>{v.value="",d.value="all",h.value={from:"",to:""},_.value={min:"",max:""},k.value="event_date_asc",u.value=1,await x.resetFilters(),E.push({query:{}}),B.value=!1},re=()=>{A.value=!A.value},O=()=>d.value!=="all"||k.value!=="event_date_asc"||h.value.from!==""||h.value.to!==""||_.value.min!==""||_.value.max!=="",j=l=>{l>=1&&l<=f.value&&(u.value=l)},S=F(()=>x.totalItems||0),D=F(()=>x.events||[]),ne=F(()=>D.value.length),ue=F(()=>{const l=(u.value-1)*L.value+1,t=Math.min(l+ne.value-1,S.value);return`Showing ${l}-${t} of ${S.value} results`}),ce=F(()=>{const l=[];if(f.value<=5)for(let a=1;a<=f.value;a++)l.push(a);else{l.push(1);let a=Math.max(2,u.value-1),s=Math.min(f.value-1,u.value+1);s-a<2&&(u.value<f.value/2?s=Math.min(f.value-1,a+2):a=Math.max(2,s-2)),a>2&&l.push("...");for(let r=a;r<=s;r++)l.push(r);s<f.value-1&&l.push("..."),l.push(f.value)}return l}),ve=[{value:"event_date_asc",label:"Date (Earliest first)"},{value:"event_date_desc",label:"Date (Latest first)"},{value:"title_asc",label:"Title (A-Z)"},{value:"title_desc",label:"Title (Z-A)"},{value:"price_asc",label:"Price (Low to High)"},{value:"price_desc",label:"Price (High to Low)"}],P=[{value:"all",label:"All Categories"},{value:"music",label:"Music"},{value:"sports",label:"Sports"},{value:"theatre",label:"Theatre"},{value:"art",label:"Art"},{value:"food",label:"Food"},{value:"tech",label:"Tech"},{value:"movies",label:"Movies"},{value:"festivals",label:"Festivals"}];return(l,t)=>{var a;return o(),i("div",Fe,[e("section",Me,[e("div",Te,[e("div",$e,[t[12]||(t[12]=e("h1",{class:"search-hero__title"},"Discover Your Next Experience",-1)),t[13]||(t[13]=e("p",{class:"search-hero__subtitle"},"Find events that match your interests and schedule",-1)),e("div",Ve,[C(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>v.value=s),onKeyup:fe(w,["enter"]),placeholder:"Search for events, artists, venues...",class:"search-hero__search-input","aria-label":"Search events"},null,544),[[I,v.value]]),e("button",{onClick:w,class:"search-hero__search-button","aria-label":"Search"},t[9]||(t[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("circle",{cx:"11",cy:"11",r:"8"}),e("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})],-1)]))]),y.value.length>0?(o(),i("div",Ie,[e("div",{class:"recent-searches__header"},[t[10]||(t[10]=e("h3",null,"Recent Searches",-1)),e("button",{onClick:oe,class:"clear-button"},"Clear")]),e("div",Ae,[(o(!0),i(M,null,T(y.value,(s,r)=>(o(),i("button",{key:r,onClick:g=>ie(s),class:"recent-search-item"},[t[11]||(t[11]=e("span",{class:"recent-search-icon"},[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("polyline",{points:"12 6 12 12 16 14"})])],-1)),W(" "+p(s),1)],8,Be))),128))])])):q("",!0),e("div",Ne,[(o(),i(M,null,T(P,s=>e("button",{key:s.value,onClick:r=>le(s.value),class:Z(["search-hero__category-tag",{active:d.value===s.value}])},p(s.label),11,ze)),64))])])])]),e("section",Ee,[e("div",Le,[e("div",Ue,[e("div",Oe,[e("h2",je,[v.value?(o(),i("span",Pe,'Search Results for "'+p(v.value)+'"',1)):d.value!=="all"?(o(),i("span",He,p((a=P.find(s=>s.value===d.value))==null?void 0:a.label)+" Events ",1)):(o(),i("span",Je,"All Events")),S.value>0?(o(),i("span",Ke,"("+p(S.value)+")",1)):q("",!0)]),S.value>0?(o(),i("p",Ze,p(ue.value),1)):q("",!0)]),e("div",Ye,[e("button",{onClick:re,class:Z(["filter-toggle-button",{active:A.value}])},[t[14]||(t[14]=e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})],-1)),t[15]||(t[15]=W(" Filters ")),B.value?(o(),i("span",De)):q("",!0)],2),e("div",Ge,[t[16]||(t[16]=e("label",{for:"sort-select"},"Sort by:",-1)),C(e("select",{id:"sort-select","onUpdate:modelValue":t[1]||(t[1]=s=>k.value=s),class:"sort-select"},[(o(),i(M,null,T(ve,s=>e("option",{key:s.value,value:s.value},p(s.label),9,We)),64))],512),[[ye,k.value]])])])]),A.value?(o(),i("div",Xe,[e("div",Qe,[e("div",Re,[t[17]||(t[17]=e("h3",{class:"filter-section__title"},"Category",-1)),e("div",et,[(o(),i(M,null,T(P,s=>e("div",{key:s.value,class:"filter-option"},[C(e("input",{type:"radio",id:`category-${s.value}`,value:s.value,"onUpdate:modelValue":t[2]||(t[2]=r=>d.value=r),name:"category"},null,8,tt),[[be,d.value]]),e("label",{for:`category-${s.value}`},p(s.label),9,st)])),64))])]),e("div",lt,[t[20]||(t[20]=e("h3",{class:"filter-section__title"},"Date Range",-1)),e("div",at,[e("div",it,[t[18]||(t[18]=e("label",{for:"date-from"},"From",-1)),C(e("input",{type:"date",id:"date-from","onUpdate:modelValue":t[3]||(t[3]=s=>h.value.from=s),class:"date-input"},null,512),[[I,h.value.from]])]),e("div",ot,[t[19]||(t[19]=e("label",{for:"date-to"},"To",-1)),C(e("input",{type:"date",id:"date-to","onUpdate:modelValue":t[4]||(t[4]=s=>h.value.to=s),class:"date-input"},null,512),[[I,h.value.to]])])])]),e("div",rt,[t[23]||(t[23]=e("h3",{class:"filter-section__title"},"Price Range",-1)),e("div",nt,[e("div",ut,[t[21]||(t[21]=e("label",{for:"price-min"},"Min $",-1)),C(e("input",{type:"number",id:"price-min","onUpdate:modelValue":t[5]||(t[5]=s=>_.value.min=s),class:"price-input",placeholder:"Min",min:"0"},null,512),[[I,_.value.min]])]),e("div",ct,[t[22]||(t[22]=e("label",{for:"price-max"},"Max $",-1)),C(e("input",{type:"number",id:"price-max","onUpdate:modelValue":t[6]||(t[6]=s=>_.value.max=s),class:"price-input",placeholder:"Max",min:"0"},null,512),[[I,_.value.max]])])])]),e("div",{class:"filter-actions"},[e("button",{onClick:U,class:"clear-filters-button"}," Clear All Filters "),e("button",{onClick:w,class:"apply-filters-button"},"Apply Filters")])])])):q("",!0),$.value?(o(),i("div",vt,[ge(we,{size:"large"}),t[24]||(t[24]=e("p",null,"Searching for events...",-1))])):V.value?(o(),i("div",dt,[t[25]||(t[25]=X('<div class="error-icon" data-v-ceb6962c><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-ceb6962c><circle cx="12" cy="12" r="10" data-v-ceb6962c></circle><line x1="12" y1="8" x2="12" y2="12" data-v-ceb6962c></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-ceb6962c></line></svg></div><h3 data-v-ceb6962c>Something went wrong</h3>',2)),e("p",null,p(V.value),1),e("button",{onClick:U,class:"retry-button"},"Try Again")])):S.value===0?(o(),i("div",ht,[t[26]||(t[26]=X('<div class="no-results-icon" data-v-ceb6962c><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" data-v-ceb6962c><circle cx="12" cy="12" r="10" data-v-ceb6962c></circle><path d="M8 15A7 7 0 0 1 17.55 6.44" data-v-ceb6962c></path><line x1="2" y1="2" x2="22" y2="22" data-v-ceb6962c></line></svg></div><h3 data-v-ceb6962c>No matching events found</h3><p data-v-ceb6962c>Try adjusting your search criteria or filters</p>',3)),e("button",{onClick:U,class:"clear-button"},"Clear All Filters")])):(o(),i("div",_t,[(o(!0),i(M,null,T(D.value,(s,r)=>(o(),i("div",{key:s.id,class:"search-results__item",style:xe({animationDelay:`${r*Y.value}ms`})},[e("div",null,p((s==null?void 0:s.title)||"No Title"),1)],4))),128))])),f.value>1?(o(),i("div",pt,[e("button",{onClick:t[7]||(t[7]=s=>j(u.value-1)),class:"pagination__arrow",disabled:u.value===1,"aria-label":"Previous page"},t[27]||(t[27]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"15 18 9 12 15 6"})],-1)]),8,mt),e("div",ft,[(o(!0),i(M,null,T(ce.value,(s,r)=>(o(),i("button",{key:r,onClick:g=>s!=="..."&&j(s),class:Z(["pagination__page",{active:s===u.value,ellipsis:s==="..."}]),disabled:s==="..."},p(s),11,yt))),128))]),e("button",{onClick:t[8]||(t[8]=s=>j(u.value+1)),class:"pagination__arrow",disabled:u.value===f.value,"aria-label":"Next page"},t[28]||(t[28]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"9 18 15 12 9 6"})],-1)]),8,gt)])):q("",!0)])])])}}},kt=ee(bt,[["__scopeId","data-v-ceb6962c"]]);export{kt as default};
